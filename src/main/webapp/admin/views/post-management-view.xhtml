<?xml version='1.0' encoding='UTF-8' ?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml"
      xmlns:h="http://xmlns.jcp.org/jsf/html"
      xmlns:p="http://primefaces.org/ui"
      xmlns:f="http://xmlns.jcp.org/jsf/core">
    <h:head>
        <meta http-equiv="X-UA-Compatible" content="IE=edge" />
        <meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
        <meta name="viewport" content="user-scalable=no, width=device-width, initial-scale=1.0, maximum-scale=1.0" />
        <meta name="apple-mobile-web-app-capable" content="yes" />
        <title>Post Administration</title>
        <meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
        <h:outputScript name="jquery/jquery-plugins.js" library="primefaces"/>
        <link href="#{request.contextPath}/resources/css/simple.css" media="screen" rel="stylesheet" type="text/css"/>
        <script type="text/javascript">
            $(window).load(function () {
                $(".loader").fadeOut("slow");
            });

            function reload() {
                setTimeout("window.location.reload(1)", 5000);
            }
        </script>
    </h:head>
    <h:body>
        <div class="loader">

        </div>


        <h:form>         
            <p:button styleClass="input" value="Volver al panel" outcome="admin-app-main"/>
            <p:commandButton styleClass="input" value="cerrar sesion" action="#{loginBean.logout}" />
        </h:form>

        <h:form id="form">
            <p:growl id="msgs" showDetail="true"/>

            <p:dataTable id="users" var="post" value="#{postBean.posts}" editable="true" reflow="true" style="margin-bottom:20px; font-size: 13px" rows="10"
                         widgetVar="usersTable" emptyMessage="No users found with given criteria" filteredValue="#{postBean.filteredPosts}"
                         paginator="true" selectionMode="single" rowKey="#{post.postId}"
                         paginatorTemplate="{CurrentPageReport}  {FirstPageLink} {PreviousPageLink} {PageLinks} {NextPageLink} {LastPageLink} {RowsPerPageDropdown} {Exporters}"
                         rowsPerPageTemplate="5,10,15">
                <f:facet name="header">
                    Users
                </f:facet>

                <f:facet name="header">
                    <p:outputPanel>
                        <h:outputText value="Search all fields:" />
                        <p:inputText id="globalFilter" onkeyup="PF('usersTable').filter()" style="width:150px" placeholder="Enter keyword"/>
                    </p:outputPanel>
                </f:facet>

                <p:ajax event="rowEdit" listener="#{postBean.onRowEdit}" update=":form:msgs" />
                <p:ajax event="rowEditCancel" listener="#{postBean.onRowCancel}" update=":form:msgs" />

                <f:facet name="{Exporters}">

                    <h:commandLink>
                        <p:graphicImage name="images/excel-icon.png" width="24"/>
                        <p:dataExporter type="xls" target="users" fileName="users" />
                    </h:commandLink>

                    <h:commandLink>
                        <p:graphicImage name="images/pdf-icon.png" width="24"/>
                        <p:dataExporter type="pdf" target="users" fileName="users"/>
                    </h:commandLink>

                    <h:commandLink>
                        <p:graphicImage name="images/csv-icon.ico" width="24"/>
                        <p:dataExporter type="csv" target="users" fileName="users" />
                    </h:commandLink>

                    <h:commandLink>
                        <p:graphicImage name="images/xml-icon.png" width="24"/>
                        <p:dataExporter type="xml" target="users" fileName="users" />
                    </h:commandLink>
                </f:facet>

                <p:column headerText="User Id" filterBy="id" filterMatchMode="contains">
                    <p:cellEditor>
                        <f:facet name="output"><h:outputText value="#{post.postId}" id="id"/></f:facet>
                        <f:facet name="input"><p:inputText id="modelInput" value="#{post.postId}" style="width:100%" label="id"/></f:facet>
                    </p:cellEditor>
                </p:column>

                <p:column headerText="Title" filterMatchMode="contains" filterBy="title">
                    <p:cellEditor>
                        <f:facet name="output"><h:outputText value="#{post.title}" id="title" /></f:facet>
                        <f:facet name="input"><p:inputText value="#{post.title}" style="width:100%" label="title"/></f:facet>
                    </p:cellEditor>
                </p:column>

                <p:column headerText="Image Path" filterMatchMode="contains" filterBy="imagePath">
                    <p:cellEditor>
                        <f:facet name="output"><h:outputText value="#{post.imagePath}" id="imagePath" /></f:facet>
                        <f:facet name="input"><p:inputText value="#{post.imagePath}" style="width:100%" label="imagePath"/></f:facet>
                    </p:cellEditor>
                </p:column>

                <p:column headerText="Post" style="width:280px;" filterMatchMode="contains" filterBy="post">
                    <p:cellEditor>

                        <f:facet name="output"><h:outputText value="#{post.post}" id="post" /></f:facet>
                        <f:facet name="input"><p:inputTextarea value="#{post.post}"  label="post"/></f:facet>
                    </p:cellEditor>
                </p:column>

                <p:column headerText="Note"  filterMatchMode="contains" filterBy="note">
                    <p:cellEditor>
                        <f:facet name="output"><h:outputText value="#{post.note}" id="note"/></f:facet>
                        <f:facet name="input"><p:inputText value="#{post.note}" label="note" /></f:facet>
                    </p:cellEditor>
                </p:column>

                <p:column headerText="Date Created" filterMatchMode="contains" filterBy="dateCreated">
                    <p:cellEditor>
                        <f:facet name="output"><h:outputText value="#{post.dateCreated}" id="dateCreated"></h:outputText></f:facet>
                        <f:facet name="input"><p:inputText requiredMessage="this field cannot be empty" value="#{post.dateCreated}" style="width:100%" label="username" required="true" placeholder="#{post.dateCreated}"><f:convertDateTime /></p:inputText></f:facet>
                    </p:cellEditor>           
                </p:column>

                <p:column headerText="Created by" filterMatchMode="contains" filterBy="createdBy">
                    <p:cellEditor>
                        <f:facet name="output"><h:outputText value="#{post.createdBy.username}" id="createdBy"></h:outputText></f:facet>
                        <f:facet name="input"><p:inputText requiredMessage="this field cannot be empty" value="#{post.createdBy.username}" style="width:100%" label="username" required="true" placeholder="#{post.dateCreated}"></p:inputText></f:facet>
                    </p:cellEditor>           
                </p:column>

                <p:column headerText="Edit" style="width:40px;">
                    <p:rowEditor />
                </p:column>

                <p:column headerText="Delete">
                    <p:commandButton value="Delete" styleClass="input" icon="ui-icon-close" action="#{postBean.remove(post.postId)}" update=":form:msgs"> 
                        <p:confirm header="Confirmation" message="Are you sure?" icon="ui-icon-alert" />
                    </p:commandButton>
                </p:column>
            </p:dataTable>

            <p:confirmDialog global="true" showEffect="fade" hideEffect="explode">
                <p:commandButton value="Yes" type="button" styleClass="ui-confirmdialog-yes" icon="ui-icon-check"/>
                <p:button value="No" styleClass="ui-confirmdialog-no" icon="ui-icon-close" outcome="users-view"/>
            </p:confirmDialog>
        </h:form>
    </h:body>
</html>

